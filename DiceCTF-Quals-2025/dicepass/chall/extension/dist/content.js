/*! For license information please see content.js.LICENSE.txt */
var __webpack_modules__={484:function(e,t,n){!function(e,t){"use strict";const n="__COMLINK_MESSAGE_CHANNEL__",s="__COMLINK_MESSAGE_PORT_MARKER__",r="message",a="Only message event is supported",o="__PROXY_MESSAGE_CHANNEL_MARKER__",i=e=>"object"==typeof e&&null!==e||"function"==typeof e,c=()=>new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-"),d=(e,t)=>t.length&&e?(null==e?void 0:e.value)===s?(e.value=t[0],e):"object"==typeof e?JSON.parse(JSON.stringify(e),((e,n)=>n&&n===s?t[0]:n)):e:e,l=new Map,p=e=>{l.has("proxy")||l.set("proxy",(e=>({canHandle:e=>i(e)&&e[t.proxyMarker],serialize(n){if(e){const{port1:r,port2:a}=new e;return t.expose(n,g(r,e)),[s,[a]]}const{port1:r,port2:a}=new MessageChannel;return t.expose(n,r),[s,[a]]},deserialize(n){n.start();const s=n instanceof MessagePort?n:g(n,e);return t.wrap(s)}}))(e)),l.has("messagePort")||l.set("messagePort",(e=>({canHandle:e=>!!(e&&"object"==typeof e&&Reflect.get(e,"start")&&Reflect.get(e,"postMessage")),serialize(t){if(e){const{port1:n,port2:r}=new e;return u(t,n),[s,[r]]}return[s,[t]]},deserialize:e=>(e.start(),e)}))(e)),t.transferHandlers.set("messagePort",l.get("messagePort")),t.transferHandlers.set("proxy",l.get("proxy"))},u=(e,t)=>{e.addEventListener("message",(e=>{t.postMessage(e.data,[])})),e.addEventListener("close",(()=>{t.close()})),t.addListener("message",(t=>{e.postMessage(t.data,[])})),t.addListener("close",(()=>{e.close()})),e.start(),t.start()};function g(e,t){p(t);const n=new WeakMap;return{start:()=>e.start(),postMessage:(t,n)=>{e.postMessage(t,n||[])},addEventListener:(t,s)=>{if(t!==r)throw new Error(a);const o=e=>{const t=d(e.data,e.ports);"handleEvent"in s?s.handleEvent({data:t,ports:e.ports}):s({data:t,ports:e.ports})};e.addListener(r,o),n.set(s,o)},removeEventListener:(t,s)=>{if(t!==r)throw new Error(a);const o=n.get(s);o&&(e.removeListener(r,o),n.delete(s))}}}const m={canHandle:e=>i(e)&&e[t.proxyMarker],serialize:()=>[null,[]],deserialize:()=>function(){throw new Error("Operation not supported")}};const f={canHandle:e=>i(e)&&e[t.proxyMarker],serialize:()=>[null,[]],deserialize:()=>function(){throw new Error("Operation not supported")}};const E=new Map,v=e=>{E.has(e)||(E.set(e,(e=>({canHandle:e=>i(e)&&e[t.proxyMarker],serialize(n){const s=c();return t.expose(n,h({socket:e,messageChannel:s})),[{[o]:s},[]]},deserialize:n=>t.wrap(h({socket:e,messageChannel:Reflect.get(n,o)}))}))(e)),e.on("disconnect",(()=>{E.has(e)&&E.delete(e)}))),t.transferHandlers.set("proxy",E.get(e))};function h(e){const t=new WeakMap,{socket:s,messageChannel:o=n}=e;return v(s),{postMessage:(e,t)=>{s.emit(o,e)},addEventListener:(e,n)=>{if(e!==r)throw new Error(a);const i=e=>{"handleEvent"in n?n.handleEvent({data:e,ports:[]}):n({data:e,ports:[]})};s.on(o,i),t.set(n,i)},removeEventListener:(e,n)=>{if(e!==r)throw new Error(a);const i=t.get(n);i&&(s.off(o,i),t.delete(n))}}}const w=new Map,_=e=>{if(!w.has(e)){w.set(e,(e=>({canHandle:e=>i(e)&&e[t.proxyMarker],serialize(n){const s=c();return t.expose(n,y({webSocket:e,messageChannel:s})),[{[o]:s},[]]},deserialize:n=>t.wrap(y({webSocket:e,messageChannel:Reflect.get(n,o)}))}))(e));const n=()=>{w.has(e)&&w.delete(e)};e.addEventListener("close",n)}t.transferHandlers.set("proxy",w.get(e))};function y(e){const{webSocket:t,messageChannel:s}=e,r=t,a=new WeakMap,o=s||n;return _(r),{postMessage:(e,t)=>{r.send(JSON.stringify({message:e,__channel__:o}))},addEventListener:(e,t)=>{const n=e=>{let n=null;try{n=JSON.parse(e.data)}catch{n=e.data}!n||!n.__channel__||!n.message||n.__channel__!==o||("handleEvent"in t?t.handleEvent({data:n.message}):t({data:n.message}))};r.addEventListener("message",n),a.set(t,n)},removeEventListener:(e,t)=>{const n=a.get(t);n&&(r.removeEventListener("message",n),a.delete(t))},start:()=>{}}}const M=new Map,b=e=>{if(!M.has(e)){M.set(e,(e=>({canHandle:e=>i(e)&&e[t.proxyMarker],serialize(n){const s=c();return t.expose(n,L({nodeProcess:e,messageChannel:s})),[{[o]:s},[]]},deserialize:n=>t.wrap(L({nodeProcess:e,messageChannel:Reflect.get(n,o)}))}))(e));const n=()=>{M.has(e)&&M.delete(e)};process.on("exit",n),process.on("disconnect",n),process.on("SIGINT",n),process.on("uncaughtException",n)}t.transferHandlers.set("proxy",M.get(e))};function L(e){const{nodeProcess:t,messageChannel:s}=e,r=new WeakMap,a=s||n;return b(t),{postMessage:(e,n)=>{t.send&&t.send({message:e,__channel__:a})},addEventListener:(e,n)=>{const s=e=>{if(!e||!e.__channel__||!e.message||e.__channel__!==a)return;const{message:t}=e;"handleEvent"in n?n.handleEvent({data:t}):n({data:t})};t.on("message",s),r.set(n,s)},removeEventListener:(e,n)=>{const s=r.get(n);s&&(t.off("message",s),r.delete(n))},start:()=>{}}}e.MESSAGE_CHANNEL_NAME=n,e.MESSAGE_EVENT_ERROR=a,e.MESSAGE_EVENT_NAME=r,e.MESSAGE_PORT_MARKER=s,e.PROXY_MESSAGE_CHANNEL_MARKER=o,e.chromeRuntimeMessageEndpoint=function(e){const{tabId:n=0,extensionId:s=""}=e||{};t.transferHandlers.set("proxy",f);const o=new Set,i=(e,t,n)=>{if(e&&o.size)for(const t of o.values())"handleEvent"in t?t.handleEvent({data:e,ports:[]}):t({data:e,ports:[]})};return s?chrome.runtime.onMessageExternal.addListener(i):chrome.runtime.onMessage.addListener(i),{start:()=>{},postMessage:(e,t)=>{n?chrome.tabs.sendMessage(n,e):s?chrome.runtime.sendMessage(s,e):chrome.runtime.sendMessage(e)},addEventListener:(e,t)=>{if(e!==r)throw new Error(a);o.add(t)},removeEventListener:(e,t)=>{if(e!==r)throw new Error(a);o.has(t)&&o.delete(t)}}},e.chromeRuntimePortEndpoint=function(e){t.transferHandlers.set("proxy",f);const n=new WeakMap;return{start:()=>{},postMessage:(t,n)=>{e.postMessage(t)},addEventListener:(t,s)=>{if(t!==r)throw new Error(a);const o=(e,t)=>{"handleEvent"in s?s.handleEvent({data:e,ports:[]}):s({data:e,ports:[]})};e.onMessage.addListener(o),n.set(s,o)},removeEventListener:(e,t)=>{if(e!==r)throw new Error(a);n.get(t)&&n.delete(t)}}},e.electronMainEndpoint=function(e){const{sender:t,ipcMain:s,messageChannelConstructor:o,channelName:i=n}=e;p(o);const c=new WeakMap;return{postMessage:(e,n)=>{t.postMessage(i,e,n)},addEventListener:(e,t)=>{if(e!==r)throw new Error(a);const n=(e,...n)=>{const{ports:s}=e,r=d(n[0],s);"handleEvent"in t?t.handleEvent({data:r,ports:s}):t({data:r,ports:s})};s.on(i,n),c.set(t,n)},removeEventListener:(e,t)=>{if(e!==r)throw new Error(a);const n=c.get(t);n&&(s.removeListener(i,n),c.delete(t))}}},e.electronMessagePortMainEndpoint=g,e.electronRendererEndpoint=function(e){p();const t=new WeakMap,{ipcRenderer:s,channelName:o=n}=e;return{postMessage:(e,t)=>{s.postMessage(o,e,t)},addEventListener:(e,n)=>{if(e!==r)throw new Error(a);const i=(e,...t)=>{const{ports:s}=e,r=d(t[0],s);"handleEvent"in n?n.handleEvent({data:r,ports:s}):n({data:r,ports:s})};s.on(o,i),t.set(n,i)},removeEventListener:(e,n)=>{if(e!==r)throw new Error(a);const i=t.get(n);i&&(s.removeListener(o,i),t.delete(n))}}},e.figmaCoreEndpoint=function(e){t.transferHandlers.set("proxy",m);const n=new WeakMap;return{postMessage:(t,n)=>{figma.ui.postMessage(t,{origin:(null==e?void 0:e.origin)||"*"})},addEventListener:(t,s)=>{if(t!==r)throw new Error(a);const o=async(t,n)=>{(null==e||!e.checkProps||await(null==e?void 0:e.checkProps(n)))&&("handleEvent"in s?s.handleEvent({data:t,ports:[]}):s({data:t,ports:[]}))};figma.ui.on(r,o),n.set(s,o)},removeEventListener:(e,t)=>{if(e!==r)throw new Error(a);const s=n.get(t);s&&(figma.ui.off(r,s),n.delete(t))}}},e.figmaUIEndpoint=function(e){t.transferHandlers.set("proxy",m);const n=new WeakMap;return{postMessage:(t,n)=>{globalThis.parent.postMessage({pluginMessage:t},{targetOrigin:(null==e?void 0:e.origin)||"*",transfer:n})},addEventListener:(e,t)=>{if(e!==r)throw new Error(a);const s=e=>{const{ports:n,data:s}=e;"handleEvent"in t?t.handleEvent({data:s.pluginMessage,ports:n}):t({data:s.pluginMessage,ports:n})};globalThis.addEventListener(r,s),n.set(t,s)},removeEventListener:(e,t)=>{if(e!==r)throw new Error(a);const s=n.get(t);s&&(globalThis.removeEventListener(r,s),n.delete(t))}}},e.nodeProcessEndpoint=L,e.socketIoEndpoint=h,e.webSocketEndpoint=y,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}(t,n(590))},590:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createEndpoint:()=>r,expose:()=>l,finalizer:()=>o,proxy:()=>y,proxyMarker:()=>s,releaseProxy:()=>a,transfer:()=>_,transferHandlers:()=>d,windowEndpoint:()=>M,wrap:()=>u});const s=Symbol("Comlink.proxy"),r=Symbol("Comlink.endpoint"),a=Symbol("Comlink.releaseProxy"),o=Symbol("Comlink.finalizer"),i=Symbol("Comlink.thrown"),c=e=>"object"==typeof e&&null!==e||"function"==typeof e,d=new Map([["proxy",{canHandle:e=>c(e)&&e[s],serialize(e){const{port1:t,port2:n}=new MessageChannel;return l(e,t),[n,[n]]},deserialize:e=>(e.start(),u(e))}],["throw",{canHandle:e=>c(e)&&i in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function l(e,t=globalThis,n=["*"]){t.addEventListener("message",(function s(r){if(!r||!r.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(n,r.origin))return void console.warn(`Invalid origin '${r.origin}' for comlink proxy`);const{id:a,type:c,path:d}=Object.assign({path:[]},r.data),u=(r.data.argumentList||[]).map(L);let g;try{const t=d.slice(0,-1).reduce(((e,t)=>e[t]),e),n=d.reduce(((e,t)=>e[t]),e);switch(c){case"GET":g=n;break;case"SET":t[d.slice(-1)[0]]=L(r.data.value),g=!0;break;case"APPLY":g=n.apply(t,u);break;case"CONSTRUCT":g=y(new n(...u));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;l(e,n),g=_(t,[t])}break;case"RELEASE":g=void 0;break;default:return}}catch(e){g={value:e,[i]:0}}Promise.resolve(g).catch((e=>({value:e,[i]:0}))).then((n=>{const[r,i]=b(n);t.postMessage(Object.assign(Object.assign({},r),{id:a}),i),"RELEASE"===c&&(t.removeEventListener("message",s),p(t),o in e&&"function"==typeof e[o]&&e[o]())})).catch((e=>{const[n,s]=b({value:new TypeError("Unserializable return value"),[i]:0});t.postMessage(Object.assign(Object.assign({},n),{id:a}),s)}))})),t.start&&t.start()}function p(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function u(e,t){const n=new Map;return e.addEventListener("message",(function(e){const{data:t}=e;if(!t||!t.id)return;const s=n.get(t.id);if(s)try{s(t)}finally{n.delete(t.id)}})),v(e,n,[],t)}function g(e){if(e)throw new Error("Proxy has been released and is not useable")}function m(e){return k(e,new Map,{type:"RELEASE"}).then((()=>{p(e)}))}const f=new WeakMap,E="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(f.get(e)||0)-1;f.set(e,t),0===t&&m(e)}));function v(e,t,n=[],s=function(){}){let o=!1;const i=new Proxy(s,{get(s,r){if(g(o),r===a)return()=>{!function(e){E&&E.unregister(e)}(i),m(e),t.clear(),o=!0};if("then"===r){if(0===n.length)return{then:()=>i};const s=k(e,t,{type:"GET",path:n.map((e=>e.toString()))}).then(L);return s.then.bind(s)}return v(e,t,[...n,r])},set(s,r,a){g(o);const[i,c]=b(a);return k(e,t,{type:"SET",path:[...n,r].map((e=>e.toString())),value:i},c).then(L)},apply(s,a,i){g(o);const c=n[n.length-1];if(c===r)return k(e,t,{type:"ENDPOINT"}).then(L);if("bind"===c)return v(e,t,n.slice(0,-1));const[d,l]=h(i);return k(e,t,{type:"APPLY",path:n.map((e=>e.toString())),argumentList:d},l).then(L)},construct(s,r){g(o);const[a,i]=h(r);return k(e,t,{type:"CONSTRUCT",path:n.map((e=>e.toString())),argumentList:a},i).then(L)}});return function(e,t){const n=(f.get(t)||0)+1;f.set(t,n),E&&E.register(e,t,e)}(i,e),i}function h(e){const t=e.map(b);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const w=new WeakMap;function _(e,t){return w.set(e,t),e}function y(e){return Object.assign(e,{[s]:!0})}function M(e,t=globalThis,n="*"){return{postMessage:(t,s)=>e.postMessage(t,n,s),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function b(e){for(const[t,n]of d)if(n.canHandle(e)){const[s,r]=n.serialize(e);return[{type:"HANDLER",name:t,value:s},r]}return[{type:"RAW",value:e},w.get(e)||[]]}function L(e){switch(e.type){case"HANDLER":return d.get(e.name).deserialize(e.value);case"RAW":return e.value}}function k(e,t,n,s){return new Promise((r=>{const a=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.set(a,r),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),s)}))}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};const Comlink=__webpack_require__(590),{chromeRuntimeMessageEndpoint}=__webpack_require__(484);console.log("[dicepass] Hello from dicepass content script!");let remote=null,id=null;const context={version:1,extensionId:chrome.runtime.id,prevPassword:null,prevUsername:null,isLoggedIn:async()=>await remote.isLoggedIn(),async hasAutofill(){if(!await context.isLoggedIn())throw new Error("Not logged in to dicepass!");return remote.hasPasswordFor(id)},async saveCredentials(e,t){if(!await remote.isLoggedIn())throw new Error("Not logged in to dicepass!");confirm("Do you want to save the credentials:\n\n"+e+":"+"*".repeat(t.length)+"\n\nfor site "+location.origin+" to dicepass?")&&(await remote.add(id,e,t),alert("Password saved to dicepass!"))},async autofill(){if(!await context.isLoggedIn())return void alert("Please log in to dicepass first!");const e=document.querySelector("[data-dicepass-username]"),t=document.querySelector("[data-dicepass-password]");if(null!==context.prevUsername&&null!==context.prevPassword)return e.value=context.prevUsername,t.value=context.prevPassword,context.prevPassword=null,void(context.prevUsername=null);if(await remote.hasPasswordFor(id)){const{username:n,password:s}=await remote.getLogin(id);return context.prevUsername=e.value,context.prevPassword=t.value,e.value=n,void(t.value=s)}e.value&&t.value?context.saveCredentials(e.value,t.value):alert("No password saved in dicepass for "+location.origin+".\nPlease enter your username and password and then click again to save.")}};async function scanPage(){if(!await context.isLoggedIn())return void console.log("[dicepass] aborting scan, not logged in");console.log("[dicepass] scanning page...");const e=document.querySelector('input[type="password"]');if(!e)return void console.log("[dicepass] no password input found");const t=document.querySelector('input[type="text"]'),n=document.querySelector('input[type="email"]');if(!t&&!n)return void console.log("[dicepass] no text or email input found");if(document.body.hasAttribute("data-dicepass-activated"))return void console.log("[dicepass] already activated");console.log("[dicepass] injecting into page..."),document.body.setAttribute("data-dicepass-activated","true"),e.setAttribute("data-dicepass-password","true"),t&&t.setAttribute("data-dicepass-username","true"),n&&n.setAttribute("data-dicepass-username","true");const s=document.createElement("img");s.className="dicepass-button",s.src=chrome.runtime.getURL("icon-transparent.png"),s.addEventListener("click",context.autofill),document.body.appendChild(s)}if((async()=>{id=await chrome.runtime.sendMessage("init-content"),remote=Comlink.wrap(chromeRuntimeMessageEndpoint())})(),!document.querySelector(".dicepass-frame")){const e=document.createElement("iframe");document.body.appendChild(e),e.name="dicepass",e.className="dicepass-frame",Comlink.expose(context,Comlink.windowEndpoint(window,e.contentWindow,window.origin))}if(!document.querySelector(".dicepass-script")){const e=document.createElement("script");e.src=chrome.runtime.getURL("inject.js"),e.className="dicepass-script",document.head.appendChild(e)}new MutationObserver((()=>setTimeout(scanPage,500))).observe(document.body,{childList:!0,subtree:!0}),setTimeout(scanPage,500);